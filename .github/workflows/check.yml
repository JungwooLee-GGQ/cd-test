name: python cicd
on:
  push:
    branches:
      - develop

jobs:
  deployment:
    runs-on: self-hosted
    strategy:
      matrix:
        include:
          - server: "121.133.17.77"
            user : "admin"
            pwd : "qwer123"
            port : "22"
        
    steps:
      - name: ls -a via ssh
        uses: garygrossgarten/github-action-ssh@release
        with:
          script: |
            cd Documents\\GitHub\\ai-python-coach-extraction-server
            git stash
            git checkout develop
            git pull
            venv\Scripts\activate
            uvicorn app.main:app --host=${{ matrix.server }} --port=8000
          host: ${{ matrix.server }}
          username: ${{ matrix.user }}
          privateKey: ${{ secrets.KEY}}
          
      
